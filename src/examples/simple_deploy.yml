description: Deploy to infrastructure with Terraform

usage:
  version: 2.1

  orbs:
    terraform: mafuyuk/terraform@dev:e9709ed

  workflows:
    deploy:
      jobs:
        # execute "terraform plan"
        - terraform/plan
        # check plan file
        - hold:
            type: approval
            requires:
              - terraform/plan
        # execute "terraform apply" with plan file
        - terraform/apply:
            requires:
              - hold
